# Patch: 2026-02-11

## Version Target

v0.1.0 (frozen) with baseline reliability and CI guardrail updates

---

## Changes

### Single-Agent Baseline Reliability Upgrade

**What Changed**:
- Refactored `src/eval/baselines.py` to support:
  - budget envelope (`tok/call/step`) with shared accounting
  - repair-on-invalid action generation flow
  - structured per-step logs in `intermediate_outputs`
  - deterministic task-seed derivation
  - RM-BoN scoring metadata and candidate selection fields
  - minimal open-loop RM-MCTS skeleton
  - fake LLM provider for no-key local/CI smoke

**Why Changed**:
- Remove hidden failure modes before real baseline runs
- Ensure fair budget semantics across baseline methods
- Make parse/debug/replay behavior auditable from trajectory logs

**Affected Experiments**:
- Week 1 baseline implementation and debug runs
- Future RM data collection quality (trajectory integrity)

### CI Smoke Guardrail

**What Changed**:
- Added `scripts/smoke_baselines_fake.sh`:
  - runs `greedy`, `rm_bon`, `rm_mcts`
  - enforces output artifacts and schema flags
  - auto-generates one-task smoke split if missing
- Added GitHub Actions workflow:
  - `.github/workflows/smoke-fake-baselines.yml`
  - matrix checks:
    - `smoke (0.0)` for normal path
    - `smoke (0.25)` for repair path
  - uploads per-matrix artifacts via isolated `OUT_ROOT`

**Why Changed**:
- Convert baseline regression detection from manual checks to required machine checks
- Prevent repair path or budget path rot from silently entering `main`

**Affected Experiments**:
- All future baseline and trajectory-related changes (pre-merge gating)

---

## Documentation Updated

- `docs/notes.md`: progress, decisions, issues, immediate next steps
- `CLAUDE.md`: current status, completed/in-progress checklist, next steps
- `docs/patches/patch_20260211.md`: this patch record

---

## Next Steps

1. Run first real-LLM baseline on a 20-task dev subset
2. Export baseline comparison table (`success`, `avg_tok`, `avg_call`, `avg_step`)
3. Lock branch protection required checks: `smoke (0.0)` + `smoke (0.25)`
4. Prepare RM data collection from validated baseline trajectories

---

## Sign-off

- **Date**: 2026-02-11
- **Author**: NextStep Team
- **Status**: Baseline stack hardened and CI smoke gating enabled
